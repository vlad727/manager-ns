## Manager for kubernetes namespaces
Application creates limit range, resource quota and role binding for new namespaces also it set annotation for namespace like "requester: system:serviceaccount:<requester-namespace>:requester-service-account"
### How to build application
```
docker build -t webhook-app .
```
### How to deploy it to k8s

#### Install with Helm
```
# Install helm before
brew install helm 
# Clone this project and install by helm
helm repo add vlku https://registry.apps.k8s.ose-prod.solution.sbt/chartrepo/vlku --username LOGIN --password TOKEN
helm pull vlku/manager-ns --untar
helm install mns ns-manager/ 

# Check installation result
kubectl get pods -n manager-ns
kubectl create namespace my-test-namespace
kubeclt log <pod> -n manager-ns
kubectl get quota,limits,rolebinding -n my-test-namespace
kubectl get ns my-test-namespace -o json | jq .metadata.annotations
```
### The list of templates
* _gen-certs.sh  ### generate certs for validating webhook
* _limitrange.yaml ### limits will be like configmap
* _namespacelist ### namespace list for this namespace won't create limits and quotas
* _net-attach-def.yaml ### networkattachementdefenition for openshift service mesh istio
* _resourcequota.yaml ### quota will be like configmap 
* clusterrolebinding-admin-ns-manager.yaml ### clusterrolebinding with clusterrole admin
* clusterrolebinding-limit-ns-manager.yaml ### clusterrolebinding allow to create limits for namespaces 
* clusterrolebinding-namespace-editor-ns-manager.yaml ### clusterrolebinding allow set annotation
* clusterrolebinding-quota-ns-manager.yaml ### clusterrolebinding allow create quota for namespaces
* configmap-files-ns-manager.yaml ### contain _resourcequota.yaml _net-attach-def.yaml _limitrange.yaml 
* deployment-ns-manager.yaml ### main deployment with image, volumes, volumemount, toleration etc.
* manager-ns-limitrange-admin.yaml ### k8s does not contain any clusterrole which one allow you create limits, so you should create it
* namespace-ns-manager.yaml ### will create namespace 
* service-account-ns-manager.yaml ### service account manager-ns
* service-ns-manager.yaml ### service for deployment
* validatingwebhook-ns-manager.yaml ### webhook which one intercept request to API k8s
* webhook.tls.secret.yaml ### tls certificate which on will be generated by gen_cert.sh will be mounted in deploy 
